if (self.CavalryLogger) { CavalryLogger.start_js(["7CW4O"]); }

__d("EmployeeLinkMatcher",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new RegExp("^[\\s.,:]"),h=new RegExp("(?:\\b)(([ABDFTPSXJNQW]|(PR )|(PO )|(CMS)|(SRT)|(Z)|(NT)|(DAP)|(FBJE)|(RE)|(IE)|(PD)|(SHUB)|(BID)|(DSQ))\\d{4,})(?:\\b)","im"),i=new RegExp("(?:\\b)(designpack://.+)(?:\\b)","im"),j=new RegExp("(?:\\b)(fb/[^\\s]+)(?:\\b)","im"),k=new RegExp("\\bT([0-9]{7,})\\b","im"),l=new RegExp("\\bD([0-9]{7,})\\b","im"),m="https://our.intern.facebook.com/intern/tasks/?t=",n="https://our.intern.facebook.com/intern/diff/D";a=function(a){if(!b("CurrentUser").isEmployee())return null;a=h.exec(a)||i.exec(a)||j.exec(a);return a===null?null:{lnk:a[1],idx:a.index+(g.exec(a[0])?1:0)}};c=function(a){if(!b("CurrentUser").isEmployee())return null;a=k.exec(a);return a===null?null:m+a[1]};d=function(a){if(!b("CurrentUser").isEmployee())return null;a=l.exec(a);return a===null?null:n+a[1]};f=function(a){a=b("CurrentUser").isEmployee()&&(h.exec(a)!==null||i.exec(a)!==null||j.exec(a)!==null);return a};a={match:a,isMatch:f,matchTaskNumber:c,matchDiffNumber:d};e.exports=a}),null);
__d("EmployeeLinkRanges",["EmployeeLinkMatcher","UnicodeUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={PHABRICATOR_PREFIX:"https://phabricator.intern.facebook.com/",TASKS_PREFIX:"https://our.intern.facebook.com/intern/tasks/?t=",BUSINESS_PREFIX:"https://our.intern.facebook.com/intern/business/?q=",SEV_PREFIX:"https://our.intern.facebook.com/intern/sevmanager/view/s/",CHRONOS_PREFIX:"https://our.intern.facebook.com/intern/chronos/lucky/?query=",ADS_PROJECT_PREFIX:"https://our.intern.facebook.com/intern/aip/project/",SRT_JOB_PREFIX:"https://our.intern.facebook.com/intern/bunny/?srt+",ANALYTICS_NOTEBOOKS_PREFIX:"https://our.intern.facebook.com/intern/bunny/?anp+",FBLEARNER_RUN_PREFIX:"https://our.intern.facebook.com/intern/fblearner/details/",PURCHASE_REQUEST_PREFIX:"https://our.intern.facebook.com/intern/bunny/?q=pr+",PURCHASE_ORDER_PREFIX:"https://our.intern.facebook.com/intern/bunny/?q=po+",WORKORDER_PREFIX:"https://our.intern.facebook.com/intern/workorder/",CMS_PREFIX:"https://our.internmc.facebook.com/intern/support/cms/editor/",FBURL_PREFIX:"https://www.fburl.com/",QA_PREFIX:"https://our.intern.facebook.com/intern/qa/",ZONCOLAN_PREFIX:"https://our.intern.facebook.com/intern/bunny/?q=z+",NTFIDDLE_PREFIX:"https://our.internmc.facebook.com/intern/nt/fiddle/",DAPPER_PREFIX:"https://our.internmc.facebook.com/intern/dapper/maintenance/",FBJE_PREFIX:"https://our.internmc.facebook.com/intern/fbje/",RESORT_PREFIX:"https://our.internmc.facebook.com/intern/resort/?ticket_num=",INTERN_EVENT_PREFIX:"https://our.internmc.facebook.com/intern/event/?num=",PRIVACY_DECISION_PREFIX:"https://our.internmc.facebook.com/intern/bunny/?q=",SECURITY_HUB_PREFIX:"https://our.internmc.facebook.com/intern/bunny/?q=",DIRECT_SUPPORT_PREFIX:"https://our.internmc.facebook.com/intern/bunny?q=dsq+",get:function(a,c){__p&&__p();c===void 0&&(c=0);var d=a.substr(c),e=b("EmployeeLinkMatcher").match(d);if(!e)return[];var f=e.lnk;e=e.idx;d=b("UnicodeUtils").strlen(d.substr(0,e));e=c+d;c="";if(f.substr(0,3).toLowerCase()==="srt")c=this.SRT_JOB_PREFIX+f.substr(3);else if(f.substr(0,3).toLowerCase()==="pr ")c=this.PURCHASE_REQUEST_PREFIX+f.substr(3);else if(f.substr(0,3).toLowerCase()==="po ")c=this.PURCHASE_ORDER_PREFIX+f.substr(3);else if(f.substr(0,3).toLowerCase()==="cms")c=this.CMS_PREFIX+f.substr(3);else if(f.substr(0,2).toLowerCase()==="nt")c=this.NTFIDDLE_PREFIX+f.substr(2);else if(f.substr(0,3).toLowerCase()==="dap")c=this.DAPPER_PREFIX+f.substr(3);else if(f.substr(0,4).toLowerCase()==="fbje")c=this.FBJE_PREFIX+f.substr(4);else if(f.substr(0,2)==="rE")c=this.PHABRICATOR_PREFIX+f;else if(f.substr(0,2).toLowerCase()==="re")c=this.RESORT_PREFIX+f.substr(2);else if(f.substr(0,2).toLowerCase()==="ie")c=this.INTERN_EVENT_PREFIX+f.substr(2);else if(f.substr(0,2).toLowerCase()==="pd")c=this.PRIVACY_DECISION_PREFIX+f;else if(f.substr(0,4).toLowerCase()==="shub")c=this.SECURITY_HUB_PREFIX+f;else if(f.substr(0,3).toLowerCase()==="bid")c=this.BUSINESS_PREFIX+f.substr(3);else if(f.substr(0,3).toLowerCase()==="dsq")c=this.DIRECT_SUPPORT_PREFIX+f.substr(3);else switch(f[0].toLowerCase()){case"a":c=this.ADS_PROJECT_PREFIX+f.substr(1);break;case"d":f.indexOf("designpack://")===0?c=f:c=this.PHABRICATOR_PREFIX+f.toUpperCase();break;case"p":c=this.PHABRICATOR_PREFIX+f.toUpperCase();break;case"t":c=this.TASKS_PREFIX+f.substr(1);break;case"s":c=this.SEV_PREFIX+f.substr(1);break;case"x":c=this.CHRONOS_PREFIX+f.substr(1);break;case"j":c=this.SRT_JOB_PREFIX+f.substr(1);break;case"n":c=this.ANALYTICS_NOTEBOOKS_PREFIX+f.substr(1);break;case"q":c=this.QA_PREFIX+f.substr(1);break;case"f":f.indexOf("fb/")===0?c="https://www.fburl.com/"+f.substr(3):c=this.FBLEARNER_RUN_PREFIX+f.substr(1);break;case"w":c=this.WORKORDER_PREFIX+f.substr(1);break;case"z":c=this.ZONCOLAN_PREFIX+f.substr(1);break;default:return[]}d=f.length;f=[{offset:e,length:d,entity:{url:c}}];return f.concat(this.get(a,e+d))},hasMatch:b("EmployeeLinkMatcher").isMatch};e.exports=a}),null);
__d("MessengerThreadSharedMediaHelper",["AsyncRequest","LogHistory","MessageSharedMediaIDStore.bs","MessengerThreadSharedMediaAfterWebGraphQLQuery","MessengerThreadSharedMediaBeforeWebGraphQLQuery","MessengerThreadSharedMediaFindWebGraphQLQuery","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LogHistory").getInstance("shared_media_helper"),h=0;a={search:function(a,c,d){var e=b("MessageSharedMediaIDStore.bs").getMessageIDForAttachmentID(c),f=h++,i=b("performanceAbsoluteNow")(),j=new(b("AsyncRequest"))(b("MessengerThreadSharedMediaFindWebGraphQLQuery").getLegacyURI({id:a,photoID:c,messageID:e}));g.debug("search request "+f,JSON.stringify({id:a,photoID:c,messageID:e,timestamp:i}));b("promiseDone")(j.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(h){var j=b("performanceAbsoluteNow")();g.debug("search response "+f,JSON.stringify({id:a,photoID:c,messageID:e,timestamp:j,duration:j-i}));d(h)});return j},loadMorePrevious:function(a,c,d,e){a=new(b("AsyncRequest"))(b("MessengerThreadSharedMediaAfterWebGraphQLQuery").getLegacyURI({id:a,after:c,first:d}));b("promiseDone")(a.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(a){return e(a)});return a},loadMoreLatest:function(a,c,d,e){a=new(b("AsyncRequest"))(b("MessengerThreadSharedMediaBeforeWebGraphQLQuery").getLegacyURI({id:a,before:c,last:d}));b("promiseDone")(a.setAllowCrossPageTransition(!0).exec().then(function(a){return a.getPayload()}),function(a){return e(a)});return a}};e.exports=a}),null);